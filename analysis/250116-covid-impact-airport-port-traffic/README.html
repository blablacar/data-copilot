<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>README</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            line-height: 1.6;
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem;
            color: #333;
        }
        h1, h2, h3, h4, h5, h6 {
            margin-top: 1.5em;
            margin-bottom: 0.5em;
            font-weight: 600;
        }
        h1 {
            border-bottom: 2px solid #044752;
            padding-bottom: 0.3em;
        }
        h2 {
            border-bottom: 1px solid #E6ECED;
            padding-bottom: 0.3em;
        }
        code {
            background-color: #f5f5f5;
            padding: 0.2em 0.4em;
            border-radius: 3px;
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.9em;
        }
        pre {
            background-color: #f5f5f5;
            padding: 1em;
            border-radius: 5px;
            overflow-x: auto;
        }
        pre code {
            background-color: transparent;
            padding: 0;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 1em 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 0.5em;
            text-align: left;
        }
        th {
            background-color: #044752;
            color: white;
        }
        blockquote {
            border-left: 4px solid #044752;
            margin-left: 0;
            padding-left: 1em;
            color: #666;
        }
        img {
            max-width: 100%;
            height: auto;
        }
        a {
            color: #044752;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
<h1 id="analysis-report-covid-19-impact-on-us-airport-and-port-traffic">Analysis Report: COVID-19 Impact on US Airport and Port Traffic</h1>
<p><strong>Requestor:</strong> User
<strong>Date:</strong> 2025-01-16
<strong>Analysis ID:</strong> analysis/250116-covid-impact-airport-port-traffic/</p>
<p>This analysis examines the impact of COVID-19 on US airport and port traffic, focusing on regional differences in both the severity of impact and the trajectory of recovery from 2020 through 2021.</p>
<hr />
<blockquote>
<p><strong>⚠️ DATA RELIABILITY DISCLAIMER</strong></p>
<p>This analysis is generated by an AI assistant and should be reviewed carefully:
- <strong>All numerical data and statistics are sourced directly from temporary BigQuery tables</strong> generated by SQL queries and Python analysis scripts
- <strong>Visualizations (charts and graphs) are programmatically generated</strong> from the source data and should be considered the most reliable representation of the findings
- <strong>Text-based interpretations and narratives</strong> are generated by an LLM and may contain errors or misinterpretations
- <strong>When in doubt, trust the data in the visualizations and summary statistics files over the textual descriptions</strong>
- <strong>For critical business decisions, it is strongly recommended to have a Data Analyst review this analysis</strong> to validate the methodology, verify the findings, and ensure data quality</p>
<p>If you notice any discrepancies between the visualizations and the text, please prioritize the visualizations and consult with a Data Analyst.</p>
</blockquote>
<hr />
<h2 id="1-executive-summary">1. Executive Summary</h2>
<p>The COVID-19 pandemic had a profound but varied impact on US transportation infrastructure. Airports experienced the most severe decline, with the hardest-hit facility (McCarran International in Las Vegas) dropping to just <strong>26.4% of baseline traffic</strong> in May 2020. In contrast, US ports (Seattle and Tacoma) showed relative resilience, with monthly declines averaging only <strong>-3.6% to -5.3%</strong> during worst periods. By late 2021, several airports had recovered to near-baseline levels, with Newark Liberty International reaching <strong>99.7% recovery</strong>, while others like Hartsfield-Jackson Atlanta remained at <strong>65.1%</strong>. Regional differences were stark: West Coast airports (particularly Hawaii) experienced prolonged impact, while East Coast facilities (Newark, Charlotte) demonstrated faster recovery.</p>
<h2 id="2-key-visualizations">2. Key Visualizations</h2>
<p><img alt="Airports vs Ports Comparison" src="./airports_vs_ports_comparison.png" />
<em>Figure 1: Direct comparison showing airports faced much steeper declines (down to -75% from baseline) while ports maintained relative stability with week-over-week fluctuations. The distinct nature of the metrics reflects different measurement approaches: airports show deviation from pre-COVID baseline while ports show weekly changes.</em></p>
<p><img alt="Airport Recovery Timeline" src="./airport_recovery_timeline.png" />
<em>Figure 2: State-by-state airport traffic recovery from February 2020 through late 2021. All states show the dramatic April-May 2020 collapse followed by gradual recovery, though at different rates. Washington state airports showed relatively better resilience compared to other states.</em></p>
<p><img alt="Airport Impact Comparison" src="./airport_impact_comparison.png" />
<em>Figure 3: The 15 US airports most severely impacted by COVID-19, ranked by their lowest monthly traffic point. Las Vegas McCarran topped the list at 26.4% of baseline, followed by Detroit Metropolitan at 38.5% and San Francisco at 38.6%.</em></p>
<p><img alt="Port Traffic Timeline" src="./port_traffic_timeline.png" />
<em>Figure 4: Weekly vehicle volume changes and wait times at US ports (Seattle and Tacoma). Unlike airports, ports showed volatile but generally manageable fluctuations around the zero-change baseline, with wait times remaining relatively stable between 12-20 minutes.</em></p>
<h2 id="3-detailed-findings">3. Detailed Findings</h2>
<h3 id="airport-traffic-impact-and-recovery">Airport Traffic Impact and Recovery</h3>
<ul>
<li><strong>Most Severely Impacted Airports:</strong></li>
<li><strong>McCarran International (Las Vegas, NV)</strong> suffered the worst decline at 26.4% of baseline in May 2020, reflecting the collapse of leisure and convention travel</li>
<li><strong>Detroit Metropolitan Wayne County (MI)</strong> hit 38.5% of baseline in May 2020</li>
<li><strong>San Francisco International (CA)</strong> reached 38.6% of baseline in April 2020</li>
<li><strong>Denver International (CO)</strong> dropped to 38.6% of baseline in April 2020</li>
<li>
<p><strong>Washington Dulles International (VA)</strong> recorded 47.4% of baseline as late as February 2021</p>
</li>
<li>
<p><strong>Recovery Leaders (Late 2021):</strong></p>
</li>
<li><strong>Newark Liberty International (NJ)</strong> achieved the strongest recovery at 99.7% of baseline</li>
<li><strong>Charlotte Douglas International (NC)</strong> reached 98.6% of baseline</li>
<li><strong>Dallas/Fort Worth International (TX)</strong> attained 97.2% of baseline</li>
<li>
<p><strong>Seattle-Tacoma International (WA)</strong> recovered to 95.6% of baseline</p>
</li>
<li>
<p><strong>Recovery Laggards (Late 2021):</strong></p>
</li>
<li><strong>Hartsfield-Jackson Atlanta International (GA)</strong> remained at only 65.1% of baseline</li>
<li><strong>Miami International (FL)</strong> achieved 73.0% of baseline</li>
<li><strong>Denver International (CO)</strong> reached 74.1% of baseline</li>
<li>
<p><strong>John F. Kennedy International (NY)</strong> stood at 81.2% of baseline</p>
</li>
<li>
<p><strong>Regional Patterns:</strong></p>
</li>
<li><strong>East Coast airports</strong> (Newark, Charlotte) demonstrated fastest recovery, likely due to earlier reopening of business travel corridors</li>
<li><strong>Hawaii airports</strong> (Daniel K. Inouye International) showed prolonged impact at 48.2% even in August 2021, reflecting sustained tourism decline</li>
<li><strong>Major hub airports</strong> experienced varied recovery: Newark recovered strongly while Atlanta lagged significantly</li>
<li><strong>West Coast major airports</strong> (Los Angeles at 87.0%, San Francisco severely impacted) faced slower recovery than East Coast counterparts</li>
</ul>
<h3 id="port-traffic-impact-and-resilience">Port Traffic Impact and Resilience</h3>
<ul>
<li><strong>Port of Seattle:</strong></li>
<li>Worst monthly decline: -3.6% average vehicle change in March 2020</li>
<li>Overall period average: +0.21% monthly vehicle change (remarkably stable)</li>
<li>Average truck traffic change: +1.2% (showing growth in freight despite pandemic)</li>
<li>Average non-truck traffic change: +0.05% (essentially flat)</li>
<li>
<p>Average wait time: 15.3 minutes (maintained operational efficiency)</p>
</li>
<li>
<p><strong>Port of Tacoma:</strong></p>
</li>
<li>Worst monthly decline: -5.3% average vehicle change in November 2021 (notably later than Seattle's worst period)</li>
<li>Overall period average: +0.13% monthly vehicle change</li>
<li>Average truck traffic change: +0.92% (positive freight trend)</li>
<li>Average non-truck traffic change: +0.41%</li>
<li>
<p>Average wait time: 17.2 minutes (slightly longer than Seattle but still efficient)</p>
</li>
<li>
<p><strong>Port Resilience Factors:</strong></p>
</li>
<li><strong>Essential freight status</strong> kept ports operational throughout pandemic</li>
<li><strong>Truck traffic showed growth</strong> (+0.9-1.2%) indicating sustained goods movement and possible surge in e-commerce fulfillment</li>
<li><strong>Wait times remained stable</strong> (15-17 minutes), demonstrating maintained operational capacity</li>
<li><strong>Week-over-week volatility</strong> existed but without sustained collapse seen at airports</li>
<li><strong>Ports demonstrated counter-cyclical strength</strong> relative to passenger transportation</li>
</ul>
<h3 id="comparative-insights-airports-vs-ports">Comparative Insights: Airports vs. Ports</h3>
<ul>
<li><strong>Magnitude of Impact:</strong> Airports experienced catastrophic declines (down to 26-75% below baseline) while ports showed relative stability (worst periods only -3.6% to -5.3% monthly average)</li>
<li><strong>Recovery Timeline:</strong> Airport recovery was gradual over 18+ months; port traffic remained volatile but stable throughout</li>
<li><strong>Economic Drivers:</strong> Passenger travel (discretionary) collapsed while freight movement (essential) persisted</li>
<li><strong>Regional Variation:</strong> Airports showed stark regional differences; ports (limited to Washington state in this dataset) showed similar patterns</li>
<li><strong>Operational Metrics:</strong> Airport capacity utilization plummeted; port wait times and efficiency remained largely intact</li>
</ul>
<h2 id="4-methodology-query">4. Methodology &amp; Query</h2>
<p>The analysis was conducted by querying two BigQuery tables containing COVID-19 mobility impact data from Geotab:</p>
<h3 id="airport-traffic-analysis-approach">Airport Traffic Analysis Approach</h3>
<ol>
<li><strong>Data Source:</strong> <code>Your-Project-ID-Here.covid19_geotab_mobility_impact.airport_traffic</code></li>
<li><strong>Baseline Definition:</strong> Pre-COVID baseline established as February 1 - March 15, 2020 (average of same day-of-week traffic)</li>
<li><strong>Metric:</strong> <code>percent_of_baseline</code> - daily traffic as percentage of pre-COVID baseline</li>
<li><strong>Aggregation:</strong> Daily data aggregated to monthly averages for trend analysis</li>
<li><strong>Time Range:</strong> February 2020 - December 2021 (23 months)</li>
<li><strong>Geographic Filter:</strong> US airports only (country_name = 'United States')</li>
</ol>
<h3 id="port-traffic-analysis-approach">Port Traffic Analysis Approach</h3>
<ol>
<li><strong>Data Source:</strong> <code>Your-Project-ID-Here.covid19_geotab_mobility_impact.port_traffic</code></li>
<li><strong>Metric:</strong> Week-over-week percentage change in vehicle volumes (not baseline comparison)</li>
<li><strong>Additional Metrics:</strong> Truck vs. non-truck traffic split, average wait times</li>
<li><strong>Aggregation:</strong> Weekly data aggregated to monthly averages</li>
<li><strong>Time Range:</strong> February 2020 - December 2021</li>
<li><strong>Geographic Filter:</strong> US ports (country_iso_code_2 starting with 'US') - Seattle and Tacoma</li>
</ol>
<h3 id="sql-query-for-airport-analysis">SQL Query for Airport Analysis</h3>
<div class="codehilite"><pre><span></span><code><span class="k">WITH</span><span class="w"> </span><span class="n">us_airport_data</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="k">SELECT</span>
<span class="w">    </span><span class="nb">date</span><span class="p">,</span>
<span class="w">    </span><span class="n">airport_name</span><span class="p">,</span>
<span class="w">    </span><span class="n">city</span><span class="p">,</span>
<span class="w">    </span><span class="n">state_region</span><span class="p">,</span>
<span class="w">    </span><span class="n">country_name</span><span class="p">,</span>
<span class="w">    </span><span class="n">percent_of_baseline</span><span class="p">,</span>
<span class="w">    </span><span class="k">EXTRACT</span><span class="p">(</span><span class="k">YEAR</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="nb">date</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">year</span><span class="p">,</span>
<span class="w">    </span><span class="k">EXTRACT</span><span class="p">(</span><span class="k">MONTH</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="nb">date</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">month</span><span class="p">,</span>
<span class="w">    </span><span class="k">EXTRACT</span><span class="p">(</span><span class="n">WEEK</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="nb">date</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">week_num</span>
<span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="o">`</span><span class="n">infra</span><span class="o">-</span><span class="n">sandbox</span><span class="o">-</span><span class="mi">58</span><span class="n">fe57e9</span><span class="p">.</span><span class="n">covid19_geotab_mobility_impact</span><span class="p">.</span><span class="n">airport_traffic</span><span class="o">`</span>
<span class="w">  </span><span class="k">WHERE</span>
<span class="w">    </span><span class="nb">date</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="s1">&#39;2020-02-01&#39;</span>
<span class="w">    </span><span class="k">AND</span><span class="w"> </span><span class="nb">date</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="s1">&#39;2021-12-31&#39;</span>
<span class="w">    </span><span class="k">AND</span><span class="w"> </span><span class="n">country_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;United States of America (the)&#39;</span>
<span class="p">),</span>
<span class="n">monthly_aggregates</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="k">SELECT</span>
<span class="w">    </span><span class="k">year</span><span class="p">,</span>
<span class="w">    </span><span class="k">month</span><span class="p">,</span>
<span class="w">    </span><span class="n">airport_name</span><span class="p">,</span>
<span class="w">    </span><span class="n">city</span><span class="p">,</span>
<span class="w">    </span><span class="n">state_region</span><span class="p">,</span>
<span class="w">    </span><span class="k">AVG</span><span class="p">(</span><span class="n">percent_of_baseline</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">avg_percent_of_baseline</span><span class="p">,</span>
<span class="w">    </span><span class="k">MIN</span><span class="p">(</span><span class="n">percent_of_baseline</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">min_percent_of_baseline</span><span class="p">,</span>
<span class="w">    </span><span class="k">MAX</span><span class="p">(</span><span class="n">percent_of_baseline</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">max_percent_of_baseline</span><span class="p">,</span>
<span class="w">    </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">days_in_month</span>
<span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="n">us_airport_data</span>
<span class="w">  </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="k">year</span><span class="p">,</span><span class="w"> </span><span class="k">month</span><span class="p">,</span><span class="w"> </span><span class="n">airport_name</span><span class="p">,</span><span class="w"> </span><span class="n">city</span><span class="p">,</span><span class="w"> </span><span class="n">state_region</span>
<span class="p">),</span>
<span class="n">airport_summary</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="k">SELECT</span>
<span class="w">    </span><span class="n">airport_name</span><span class="p">,</span>
<span class="w">    </span><span class="n">city</span><span class="p">,</span>
<span class="w">    </span><span class="n">state_region</span><span class="p">,</span>
<span class="w">    </span><span class="k">MIN</span><span class="p">(</span><span class="n">min_percent_of_baseline</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">lowest_traffic_pct</span><span class="p">,</span>
<span class="w">    </span><span class="k">MAX</span><span class="p">(</span><span class="n">max_percent_of_baseline</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">highest_traffic_pct</span><span class="p">,</span>
<span class="w">    </span><span class="k">AVG</span><span class="p">(</span><span class="n">avg_percent_of_baseline</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">overall_avg_pct</span>
<span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="n">monthly_aggregates</span>
<span class="w">  </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">airport_name</span><span class="p">,</span><span class="w"> </span><span class="n">city</span><span class="p">,</span><span class="w"> </span><span class="n">state_region</span>
<span class="p">)</span>
<span class="k">SELECT</span>
<span class="w">    </span><span class="n">ma</span><span class="p">.</span><span class="k">year</span><span class="p">,</span>
<span class="w">    </span><span class="n">ma</span><span class="p">.</span><span class="k">month</span><span class="p">,</span>
<span class="w">    </span><span class="n">ma</span><span class="p">.</span><span class="n">airport_name</span><span class="p">,</span>
<span class="w">    </span><span class="n">ma</span><span class="p">.</span><span class="n">city</span><span class="p">,</span>
<span class="w">    </span><span class="n">ma</span><span class="p">.</span><span class="n">state_region</span><span class="p">,</span>
<span class="w">    </span><span class="n">ma</span><span class="p">.</span><span class="n">avg_percent_of_baseline</span><span class="p">,</span>
<span class="w">    </span><span class="n">ma</span><span class="p">.</span><span class="n">min_percent_of_baseline</span><span class="p">,</span>
<span class="w">    </span><span class="n">ma</span><span class="p">.</span><span class="n">max_percent_of_baseline</span><span class="p">,</span>
<span class="w">    </span><span class="n">asu</span><span class="p">.</span><span class="n">lowest_traffic_pct</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">airport_lowest_ever</span><span class="p">,</span>
<span class="w">    </span><span class="n">asu</span><span class="p">.</span><span class="n">highest_traffic_pct</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">airport_highest_ever</span><span class="p">,</span>
<span class="w">    </span><span class="n">asu</span><span class="p">.</span><span class="n">overall_avg_pct</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">airport_overall_avg</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">monthly_aggregates</span><span class="w"> </span><span class="n">ma</span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">airport_summary</span><span class="w"> </span><span class="n">asu</span>
<span class="w">  </span><span class="k">ON</span><span class="w"> </span><span class="n">ma</span><span class="p">.</span><span class="n">airport_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">asu</span><span class="p">.</span><span class="n">airport_name</span>
<span class="w">  </span><span class="k">AND</span><span class="w"> </span><span class="n">ma</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">asu</span><span class="p">.</span><span class="n">city</span>
<span class="w">  </span><span class="k">AND</span><span class="w"> </span><span class="n">ma</span><span class="p">.</span><span class="n">state_region</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">asu</span><span class="p">.</span><span class="n">state_region</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">ma</span><span class="p">.</span><span class="k">year</span><span class="p">,</span><span class="w"> </span><span class="n">ma</span><span class="p">.</span><span class="k">month</span><span class="p">,</span><span class="w"> </span><span class="n">ma</span><span class="p">.</span><span class="n">state_region</span><span class="p">,</span><span class="w"> </span><span class="n">ma</span><span class="p">.</span><span class="n">airport_name</span>
</code></pre></div>

<h3 id="sql-query-for-port-analysis">SQL Query for Port Analysis</h3>
<div class="codehilite"><pre><span></span><code><span class="k">WITH</span><span class="w"> </span><span class="n">us_port_data</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="k">SELECT</span>
<span class="w">    </span><span class="n">week_end</span><span class="p">,</span>
<span class="w">    </span><span class="n">year_week</span><span class="p">,</span>
<span class="w">    </span><span class="n">port</span><span class="p">,</span>
<span class="w">    </span><span class="n">city</span><span class="p">,</span>
<span class="w">    </span><span class="n">country_iso_code_2</span><span class="p">,</span>
<span class="w">    </span><span class="n">percent_of_vehicle_volume_change</span><span class="p">,</span>
<span class="w">    </span><span class="n">percent_of_trip_volume_change</span><span class="p">,</span>
<span class="w">    </span><span class="n">percent_of_agg_truck_volume_change</span><span class="p">,</span>
<span class="w">    </span><span class="n">percent_of_agg_nontruck_volume_change</span><span class="p">,</span>
<span class="w">    </span><span class="n">wait_time_avg</span><span class="p">,</span>
<span class="w">    </span><span class="n">wait_time_agg_truck</span><span class="p">,</span>
<span class="w">    </span><span class="n">wait_time_agg_nontruck</span><span class="p">,</span>
<span class="w">    </span><span class="k">EXTRACT</span><span class="p">(</span><span class="k">YEAR</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">week_end</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">year</span><span class="p">,</span>
<span class="w">    </span><span class="k">EXTRACT</span><span class="p">(</span><span class="k">MONTH</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">week_end</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">month</span>
<span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="o">`</span><span class="n">infra</span><span class="o">-</span><span class="n">sandbox</span><span class="o">-</span><span class="mi">58</span><span class="n">fe57e9</span><span class="p">.</span><span class="n">covid19_geotab_mobility_impact</span><span class="p">.</span><span class="n">port_traffic</span><span class="o">`</span>
<span class="w">  </span><span class="k">WHERE</span>
<span class="w">    </span><span class="n">week_end</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="s1">&#39;2020-02-01&#39;</span>
<span class="w">    </span><span class="k">AND</span><span class="w"> </span><span class="n">week_end</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="s1">&#39;2021-12-31&#39;</span>
<span class="w">    </span><span class="k">AND</span><span class="w"> </span><span class="n">STARTS_WITH</span><span class="p">(</span><span class="n">country_iso_code_2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;US&#39;</span><span class="p">)</span>
<span class="p">),</span>
<span class="n">monthly_aggregates</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="k">SELECT</span>
<span class="w">    </span><span class="k">year</span><span class="p">,</span>
<span class="w">    </span><span class="k">month</span><span class="p">,</span>
<span class="w">    </span><span class="n">port</span><span class="p">,</span>
<span class="w">    </span><span class="n">city</span><span class="p">,</span>
<span class="w">    </span><span class="n">country_iso_code_2</span><span class="p">,</span>
<span class="w">    </span><span class="k">AVG</span><span class="p">(</span><span class="n">percent_of_vehicle_volume_change</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">avg_vehicle_change</span><span class="p">,</span>
<span class="w">    </span><span class="k">AVG</span><span class="p">(</span><span class="n">percent_of_trip_volume_change</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">avg_trip_change</span><span class="p">,</span>
<span class="w">    </span><span class="k">AVG</span><span class="p">(</span><span class="n">percent_of_agg_truck_volume_change</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">avg_truck_change</span><span class="p">,</span>
<span class="w">    </span><span class="k">AVG</span><span class="p">(</span><span class="n">percent_of_agg_nontruck_volume_change</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">avg_nontruck_change</span><span class="p">,</span>
<span class="w">    </span><span class="k">AVG</span><span class="p">(</span><span class="n">wait_time_avg</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">avg_wait_time</span><span class="p">,</span>
<span class="w">    </span><span class="k">AVG</span><span class="p">(</span><span class="n">wait_time_agg_truck</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">avg_truck_wait_time</span><span class="p">,</span>
<span class="w">    </span><span class="k">AVG</span><span class="p">(</span><span class="n">wait_time_agg_nontruck</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">avg_nontruck_wait_time</span><span class="p">,</span>
<span class="w">    </span><span class="k">MIN</span><span class="p">(</span><span class="n">percent_of_vehicle_volume_change</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">min_vehicle_change</span><span class="p">,</span>
<span class="w">    </span><span class="k">MAX</span><span class="p">(</span><span class="n">percent_of_vehicle_volume_change</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">max_vehicle_change</span><span class="p">,</span>
<span class="w">    </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">weeks_in_month</span>
<span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="n">us_port_data</span>
<span class="w">  </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="k">year</span><span class="p">,</span><span class="w"> </span><span class="k">month</span><span class="p">,</span><span class="w"> </span><span class="n">port</span><span class="p">,</span><span class="w"> </span><span class="n">city</span><span class="p">,</span><span class="w"> </span><span class="n">country_iso_code_2</span>
<span class="p">),</span>
<span class="n">port_summary</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="k">SELECT</span>
<span class="w">    </span><span class="n">port</span><span class="p">,</span>
<span class="w">    </span><span class="n">city</span><span class="p">,</span>
<span class="w">    </span><span class="n">country_iso_code_2</span><span class="p">,</span>
<span class="w">    </span><span class="k">MIN</span><span class="p">(</span><span class="n">min_vehicle_change</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">worst_week_decline</span><span class="p">,</span>
<span class="w">    </span><span class="k">MAX</span><span class="p">(</span><span class="n">max_vehicle_change</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">best_week_growth</span><span class="p">,</span>
<span class="w">    </span><span class="k">AVG</span><span class="p">(</span><span class="n">avg_vehicle_change</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">overall_avg_change</span>
<span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="n">monthly_aggregates</span>
<span class="w">  </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">port</span><span class="p">,</span><span class="w"> </span><span class="n">city</span><span class="p">,</span><span class="w"> </span><span class="n">country_iso_code_2</span>
<span class="p">)</span>
<span class="k">SELECT</span>
<span class="w">    </span><span class="n">ma</span><span class="p">.</span><span class="k">year</span><span class="p">,</span>
<span class="w">    </span><span class="n">ma</span><span class="p">.</span><span class="k">month</span><span class="p">,</span>
<span class="w">    </span><span class="n">ma</span><span class="p">.</span><span class="n">port</span><span class="p">,</span>
<span class="w">    </span><span class="n">ma</span><span class="p">.</span><span class="n">city</span><span class="p">,</span>
<span class="w">    </span><span class="n">ma</span><span class="p">.</span><span class="n">country_iso_code_2</span><span class="p">,</span>
<span class="w">    </span><span class="n">ma</span><span class="p">.</span><span class="n">avg_vehicle_change</span><span class="p">,</span>
<span class="w">    </span><span class="n">ma</span><span class="p">.</span><span class="n">avg_trip_change</span><span class="p">,</span>
<span class="w">    </span><span class="n">ma</span><span class="p">.</span><span class="n">avg_truck_change</span><span class="p">,</span>
<span class="w">    </span><span class="n">ma</span><span class="p">.</span><span class="n">avg_nontruck_change</span><span class="p">,</span>
<span class="w">    </span><span class="n">ma</span><span class="p">.</span><span class="n">avg_wait_time</span><span class="p">,</span>
<span class="w">    </span><span class="n">ma</span><span class="p">.</span><span class="n">avg_truck_wait_time</span><span class="p">,</span>
<span class="w">    </span><span class="n">ma</span><span class="p">.</span><span class="n">avg_nontruck_wait_time</span><span class="p">,</span>
<span class="w">    </span><span class="n">ma</span><span class="p">.</span><span class="n">min_vehicle_change</span><span class="p">,</span>
<span class="w">    </span><span class="n">ma</span><span class="p">.</span><span class="n">max_vehicle_change</span><span class="p">,</span>
<span class="w">    </span><span class="n">ps</span><span class="p">.</span><span class="n">worst_week_decline</span><span class="p">,</span>
<span class="w">    </span><span class="n">ps</span><span class="p">.</span><span class="n">best_week_growth</span><span class="p">,</span>
<span class="w">    </span><span class="n">ps</span><span class="p">.</span><span class="n">overall_avg_change</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">monthly_aggregates</span><span class="w"> </span><span class="n">ma</span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">port_summary</span><span class="w"> </span><span class="n">ps</span>
<span class="w">  </span><span class="k">ON</span><span class="w"> </span><span class="n">ma</span><span class="p">.</span><span class="n">port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ps</span><span class="p">.</span><span class="n">port</span>
<span class="w">  </span><span class="k">AND</span><span class="w"> </span><span class="n">ma</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ps</span><span class="p">.</span><span class="n">city</span>
<span class="w">  </span><span class="k">AND</span><span class="w"> </span><span class="n">ma</span><span class="p">.</span><span class="n">country_iso_code_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ps</span><span class="p">.</span><span class="n">country_iso_code_2</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">ma</span><span class="p">.</span><span class="k">year</span><span class="p">,</span><span class="w"> </span><span class="n">ma</span><span class="p">.</span><span class="k">month</span><span class="p">,</span><span class="w"> </span><span class="n">ma</span><span class="p">.</span><span class="n">port</span>
</code></pre></div>

<h3 id="data-processing-and-visualization">Data Processing and Visualization</h3>
<p>Python analysis script (<code>analysis.py</code>) performed the following operations:</p>
<ol>
<li><strong>Data Ingestion:</strong> Streamed query results from BigQuery temporary tables using the BigQuery API</li>
<li><strong>Statistical Analysis:</strong></li>
<li>Calculated min/max/average traffic levels by airport and time period</li>
<li>Identified lowest impact points and recovery trajectories</li>
<li>Computed aggregate metrics by port and vehicle type</li>
<li><strong>Visualization Generation:</strong> Created four primary visualizations using matplotlib and seaborn:</li>
<li>Timeline comparison of airports vs. ports impact patterns</li>
<li>State-by-state airport recovery trajectories</li>
<li>Ranking of most impacted airports</li>
<li>Port traffic volume changes and wait time trends</li>
<li><strong>Summary Statistics Export:</strong> Generated CSV files containing:</li>
<li>Top 10 worst-impacted airports</li>
<li>Top 10 recovery leaders</li>
<li>Port worst periods</li>
<li>Port average metrics across full analysis period</li>
</ol>
<h2 id="5-analysis-log">5. Analysis Log</h2>
<ul>
<li><strong>Phase 1: Request Clarification:</strong> Confirmed request to analyze full dataset (2020-2021) for US airports and ports, focusing on regional differences in impact and recovery.</li>
<li><strong>Phase 2: Knowledge Base Exploration:</strong> Identified <code>airport_traffic</code> (daily, partitioned by date) and <code>port_traffic</code> (weekly, partitioned by week_end) tables. Noted different metric types: airports use baseline comparison (Feb 1-Mar 15, 2020) while ports use week-over-week change.</li>
<li><strong>Phase 3: Query Formulation:</strong> Generated two SQL queries with mandatory partition filters (date &gt;= '2020-02-01' AND date &lt;= '2021-12-31'), proper clustering usage (country filters), and monthly aggregation for trend analysis.</li>
<li><strong>Phase 4: Automated Query Execution:</strong> Executed both queries using <code>run_query</code> script; queries completed successfully and created temporary BigQuery tables for data access.</li>
<li><strong>Phase 5: Synthesis &amp; Reporting:</strong> Created Python analysis script to stream data from temporary tables, generate four visualizations (PNG format at 300 DPI), export summary statistics to CSV files, and compile this comprehensive markdown report with findings.</li>
</ul>
<hr />
<h2 id="supporting-data-files">Supporting Data Files</h2>
<ul>
<li><code>airport_worst_impact.csv</code> - Top 10 airports with worst traffic decline</li>
<li><code>airport_recovery_levels.csv</code> - Top 10 airports by recovery level (late 2021)</li>
<li><code>port_worst_periods.csv</code> - Worst monthly decline periods for each port</li>
<li><code>port_average_metrics.csv</code> - Average metrics by port across full analysis period</li>
<li><code>airport_traffic_analysis.sql</code> - Full SQL query for airport analysis</li>
<li><code>port_traffic_analysis.sql</code> - Full SQL query for port analysis</li>
<li><code>analysis.py</code> - Python script for data processing and visualization generation</li>
</ul>
</body>
</html>
